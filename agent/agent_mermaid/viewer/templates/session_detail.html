<!DOCTYPE html>
<html class="dark" lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Session {{ session_id_short }} | Agent Monitor</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
<script id="tailwind-config">
  tailwind.config = {
    darkMode: "class",
    theme: {
      extend: {
        colors: {
          "primary": "#0df2f2",
          "background-light": "#f5f8f8",
          "background-dark": "#102222",
        },
        fontFamily: { "display": ["Inter"], "mono": ["JetBrains Mono", "monospace"] },
        borderRadius: { "DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px" },
      },
    },
  };
</script>
<style>
  .custom-scrollbar::-webkit-scrollbar { width: 6px; }
  .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
  .custom-scrollbar::-webkit-scrollbar-thumb { background: #283939; border-radius: 10px; }
  .node-glow { box-shadow: 0 0 15px rgba(13, 242, 242, 0.4); border: 2px solid #0df2f2 !important; }
  .traversal-arrow::after {
    content: "navigate_next";
    font-family: 'Material Symbols Outlined';
    margin-left: 8px;
    margin-right: 8px;
    color: #4a6666;
    vertical-align: middle;
  }
  .material-symbols-outlined { font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24; }
</style>
</head>
<body class="bg-background-light dark:bg-background-dark font-display text-slate-900 dark:text-slate-100 antialiased overflow-hidden h-screen flex flex-col">
<header class="flex items-center justify-between border-b border-slate-200 dark:border-[#283939] px-6 py-3 bg-white dark:bg-background-dark z-20">
  <div class="flex items-center gap-4">
    <div class="size-8 bg-primary/20 rounded-lg flex items-center justify-center">
      <span class="material-symbols-outlined text-primary text-xl">account_tree</span>
    </div>
    <div>
      <h2 class="text-sm font-bold leading-tight tracking-tight uppercase text-slate-500 dark:text-slate-400">Agent Session</h2>
      <div class="flex items-center gap-2">
        <span class="text-lg font-bold text-slate-900 dark:text-white font-mono">{{ session_id_short }}</span>
        {{ live_indicator }}
      </div>
    </div>
  </div>
  <div class="flex items-center gap-4">
    <div class="hidden md:flex items-center gap-6 mr-6 border-r border-slate-200 dark:border-[#283939] pr-6">
      <a class="text-slate-600 dark:text-slate-300 hover:text-primary text-sm font-medium transition-colors" href="{{ viewer_base }}/">Dashboard</a>
      <a class="text-primary text-sm font-bold border-b-2 border-primary py-4 -mb-4 transition-colors" href="{{ viewer_base }}/">Sessions</a>
      <a class="text-slate-600 dark:text-slate-300 hover:text-primary text-sm font-medium transition-colors" href="#">Settings</a>
    </div>
    <div class="flex gap-2">
      <button class="flex size-9 cursor-pointer items-center justify-center rounded-lg bg-slate-100 dark:bg-[#283939] text-slate-700 dark:text-white hover:bg-primary/20 hover:text-primary transition-all" title="Pause">
        <span class="material-symbols-outlined text-[20px]">pause</span>
      </button>
      <button class="flex size-9 cursor-pointer items-center justify-center rounded-lg bg-slate-100 dark:bg-[#283939] text-slate-700 dark:text-white hover:bg-primary/20 hover:text-primary transition-all" onclick="location.reload()" title="Refresh">
        <span class="material-symbols-outlined text-[20px]">refresh</span>
      </button>
      <button class="flex size-9 cursor-pointer items-center justify-center rounded-lg bg-slate-100 dark:bg-[#283939] text-slate-700 dark:text-white hover:bg-primary/20 hover:text-primary transition-all" title="Download">
        <span class="material-symbols-outlined text-[20px]">download</span>
      </button>
    </div>
    <div class="h-8 w-8 rounded-full bg-slate-200 dark:bg-[#283939] ml-2 border border-primary/20"></div>
  </div>
</header>
<main class="flex flex-1 overflow-hidden">
  <section class="w-2/5 flex flex-col border-r border-slate-200 dark:border-[#283939] bg-slate-50 dark:bg-[#0d1a1a] min-w-0">
    <div class="px-4 py-3 border-b border-slate-200 dark:border-[#283939] flex justify-between items-center bg-white dark:bg-background-dark">
      <div class="flex items-center gap-2">
        <span class="material-symbols-outlined text-sm text-slate-500">terminal</span>
        <h3 class="text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400">Execution Logs</h3>
      </div>
      <span class="text-[10px] px-1.5 py-0.5 rounded bg-slate-200 dark:bg-[#283939] text-slate-600 dark:text-slate-400 font-mono truncate max-w-[120px]">{{ session_id_short }}</span>
    </div>
    <div class="flex-1 overflow-y-auto custom-scrollbar p-4 font-mono text-sm">
      <div class="space-y-4">
        {{ execution_logs }}
      </div>
    </div>
  </section>
  <section class="flex-1 flex flex-col bg-slate-100 dark:bg-[#0a1111] relative min-w-0">
    <div class="px-4 py-3 border-b border-slate-200 dark:border-[#283939] flex justify-between items-center bg-white dark:bg-background-dark">
      <div class="flex items-center gap-2">
        <span class="material-symbols-outlined text-sm text-slate-500">hub</span>
        <h3 class="text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400">Process Graph</h3>
      </div>
      <div class="flex items-center gap-4 text-[11px] text-slate-400 font-medium">
        <div class="flex items-center gap-1.5">
          <span class="size-2 rounded-full bg-primary/40 border border-primary"></span>
          <span>Visited</span>
        </div>
        <div class="flex items-center gap-1.5">
          <span class="size-2 rounded-full bg-primary node-glow"></span>
          <span class="text-primary">Current</span>
        </div>
        <div class="flex items-center gap-1.5">
          <span class="size-2 rounded-full bg-slate-400 dark:bg-slate-700"></span>
          <span>Pending</span>
        </div>
      </div>
    </div>
    <div class="flex-1 p-8 overflow-auto flex flex-col">
      {{ process_graph }}
    </div>
    <div class="h-20 border-t border-slate-200 dark:border-[#283939] bg-white dark:bg-background-dark px-6 flex items-center gap-4 overflow-x-auto custom-scrollbar shrink-0">
      <span class="text-[10px] font-bold uppercase tracking-widest text-slate-500 dark:text-slate-400 whitespace-nowrap">Traversal Path</span>
      <div class="flex items-center flex-wrap gap-1">
        {{ traversal_path }}
      </div>
    </div>
  </section>
</main>
<footer class="h-8 border-t border-slate-200 dark:border-[#283939] bg-white dark:bg-[#0d1a1a] px-4 flex items-center justify-between text-[10px] font-medium text-slate-500 dark:text-[#5c7a7a] shrink-0">
  <div class="flex items-center gap-4">
    <div class="flex items-center gap-1.5">
      <span class="material-symbols-outlined text-[12px] text-emerald-500">check_circle</span>
      <span>System Health: Nominal</span>
    </div>
    <div class="flex items-center gap-1.5">
      <span class="material-symbols-outlined text-[12px]">timer</span>
      <span>Total Uptime: {{ total_uptime }}</span>
    </div>
  </div>
  <div class="flex items-center gap-4">
    <span>v2.4.0-stable</span>
    <span class="text-primary font-bold">SOP MCP</span>
  </div>
</footer>
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<script>mermaid.initialize({ startOnLoad: true, theme: "dark" });</script>
</body>
</html>
